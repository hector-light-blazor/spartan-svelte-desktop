<!doctype html>
<html>
<head>
	<meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<title>Svelte app</title>

	<link rel='icon' type='image/png' href='favicon.png'>
	<!-- <link rel='stylesheet' href='global.css'> -->
	<link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.metroui.org.ua/v4/css/metro-all.min.css">

	<link rel='stylesheet' href='./bundle.css'>

	<link rel="stylesheet" href="https://js.arcgis.com/3.28/esri/css/esri.css">
	<style>

		@font-face {
			font-family: segoe;
			src: url(fonts/SegMDL2.ttf);
		}
		body{
			font-family: 'Ubuntu', sans-serif;
			background: rgb(2,0,36);
            background: linear-gradient(90deg, rgba(2,0,36,1) 0%, rgba(91,113,162,1) 35%, rgba(36,60,115,1) 100%);
            color:white;
            overflow: hidden;
		}
		.content-holder {
			background: #243C73 !important;
		}

		.ribbon-button {
			background: transparent !important;
			color: white !important;
		}
		.tabs-holder {
			color: white !important;
		}
		.ribbon-menu .tabs-holder li {
			background: #05173F !important;
			color: white !important;
			cursor: pointer;
		}
		.ribbon-menu .tabs-holder .active {
			background: #243C73 !important;
		}
		.ribbon-menu .content-holder .group .title{
			border-top: 1px solid #D55441;
		}

		.ribbon-menu .content-holder .section{
			border-bottom: transparent;
		}

		.window-caption {
			background: #243C73;
        }
        
        .shortCut {
            height: 100vh;
        }
	</style>
</head>
<script>

    //Here add all the global node requirements..
    const remote = require('electron').remote;
    const {Client} = require('pg');
	const api = require('./configurations/api');
	const dns = require('dns')
	const osystem = require('os');
	
	let db = null;
	let client = null;
	let client_status = true;

	//IF DB JSON is not there then tell the system not to connect to database

	try {
		db = require('./configurations/db');
		client_status = (Object.entries(db).length === 0) ? false : true;

	} catch (error) {
		client_status = false;
	}


	//Only create a client if there is a db json..
	//if connected lets check first if we are in local network.
	if(client_status) {
	
		// DO DNS LOOK UP local network connect to db
		// if not fail over to API http request 
		dns.lookup('911.local', {all: true}, (err, addresses) =>
				client_status = (addresses.length > 0) ? true : false
			);
		if(client_status) {
			try { //Try to connect if fail then tell the app to switch
				client = new Client(db) //Connect to database...
			} catch (error) {
				client_status = false;
			}
		}	
	}
    
</script>

<body>
	<script defer async src="./js/socket.io.js"></script>
    <script src="./js/init.js"></script>
    <script src="./js/windowEvents.js"></script>
	<script defer async src='./bundle.js'></script>
	
	
</body>
</html>